<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>YAHIA SHOP | LIVE</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Bodoni+Moda:ital,wght@0,900&family=Inter:wght@400;900&display=swap" rel="stylesheet">
    <style>
        :root { --accent-gold: #c5a059; --canvas-bg: #faf9f6; }
        body { font-family: 'Inter', sans-serif; background: var(--canvas-bg); color: #1a1a1a; overflow-x: hidden; }
        .serif { font-family: 'Bodoni Moda', serif; }
        
        #preview-box {
            transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            text-shadow: 0 1px 0 #ccc, 0 2px 0 #c5c5c5, 0 3px 0 #bbb, 0 10px 20px rgba(0,0,0,0.2);
        }

        .gold-plate {
            background: linear-gradient(135deg, #bf953f, #fcf6ba, #b38728) !important;
            border: 10px double #8a6d3b !important;
            box-shadow: inset 0 0 50px rgba(0,0,0,0.1), 0 20px 40px rgba(0,0,0,0.2) !important;
        }

        .ticker { background: #000; color: var(--accent-gold); height: 30px; display: flex; align-items: center; font-size: 10px; font-weight: 900; overflow: hidden; }
        .ticker-move { display: inline-block; white-space: nowrap; padding-left: 100%; animation: scroll 25s linear infinite; }
        @keyframes scroll { 0% { transform: translateX(0); } 100% { transform: translateX(-100%); } }
        
        .glass { background: white; border: 1px solid rgba(0,0,0,0.05); box-shadow: 0 20px 40px rgba(0,0,0,0.05); }
        .hidden { display: none !important; }
        
        .dot { width: 35px; height: 35px; border-radius: 50%; cursor: pointer; border: 3px solid white; box-shadow: 0 2px 5px rgba(0,0,0,0.1); }
        .dot.active { border-color: black; transform: scale(1.1); }
    </style>
</head>
<body class="min-h-screen flex flex-col">

    <div class="ticker">
        <div class="ticker-move uppercase">GLOBAL CLOUD SYNC ACTIVE • ALL ORDERS SENT TO YAHIA • CHOOSE YOUR 3D SIGIL • PAY AT SCHOOL</div>
    </div>

    <nav class="p-8 flex justify-between items-center">
        <div class="flex items-center gap-4 cursor-pointer" onclick="go('home')">
            <div class="w-12 h-12 bg-black text-white rounded-full flex items-center justify-center serif font-black text-2xl">Y</div>
            <span class="font-black uppercase tracking-widest text-sm">Yahia <span class="text-[#c5a059]">Cloud</span></span>
        </div>
        <button onclick="go('login')" class="text-[10px] font-black uppercase tracking-widest border-b-2 border-black">Portal Access</button>
    </nav>

    <main class="flex-grow flex items-center justify-center p-6">
        <div id="home" class="w-full max-w-6xl grid grid-cols-1 lg:grid-cols-2 gap-20 items-center">
            <div class="space-y-10">
                <h1 class="text-8xl serif font-black leading-none uppercase tracking-tighter">Live<br><span class="text-[#c5a059]">Order</span></h1>
                <div class="glass p-10 rounded-[2.5rem] space-y-8">
                    <input type="text" id="cust-name" placeholder="Enter Your Name" class="w-full p-5 rounded-2xl bg-gray-50 border-none ring-1 ring-gray-100 text-lg">
                    <div class="grid grid-cols-2 gap-6">
                        <select id="letter" class="p-5 rounded-2xl bg-gray-50 ring-1 ring-gray-100 font-bold uppercase text-sm"></select>
                        <div class="flex gap-4 items-center justify-center bg-gray-50 rounded-2xl p-2">
                            <div id="dot-yellow" class="dot bg-yellow-400 active" onclick="setCol('#facc15', 'Yellow')"></div>
                            <div id="dot-brown" class="dot bg-amber-800" onclick="setCol('#92400e', 'Light Brown')"></div>
                        </div>
                    </div>
                    <div class="flex items-center gap-4 p-5 bg-black/5 rounded-2xl cursor-pointer" onclick="toggleR()">
                        <div id="rBox" class="w-6 h-6 border-2 border-black rounded flex items-center justify-center text-[10px] font-bold"></div>
                        <span class="font-black serif text-[#c5a059] italic uppercase text-sm tracking-widest">Imperial Gold Plate</span>
                    </div>
                    <button id="submit-btn" onclick="placeOrder()" class="w-full bg-black text-white py-6 rounded-2xl font-black uppercase text-xs tracking-[0.3em]">Submit Commission</button>
                </div>
            </div>
            <div id="preview-cont" class="w-full max-w-md aspect-[4/5] glass rounded-[4rem] flex items-center justify-center relative transition-all duration-700">
                <div id="preview-box" class="text-[18rem] serif font-black">Y</div>
            </div>
        </div>

        <div id="login" class="hidden w-full max-w-sm glass p-12 rounded-[3rem] text-center">
            <h2 class="text-xl font-black uppercase tracking-widest mb-8">Security Check</h2>
            <input type="password" id="pass" placeholder="KEY" class="w-full p-5 rounded-2xl text-center tracking-[1em] mb-6 border-none ring-1 ring-gray-200">
            <button onclick="auth()" class="w-full bg-black text-white py-5 rounded-2xl font-black uppercase text-xs">Unlock Ledger</button>
        </div>

        <div id="admin" class="hidden w-full max-w-4xl space-y-8">
            <div class="flex justify-between items-end">
                <h2 class="text-5xl serif font-black">Global <span class="text-[#c5a059]">Ledger</span></h2>
                <button onclick="go('home')" class="bg-black text-white px-8 py-3 rounded-xl text-[10px] font-black uppercase">Close</button>
            </div>
            <div class="glass rounded-[2rem] overflow-hidden">
                <table class="w-full text-left">
                    <thead><tr class="border-b"><th class="p-8 text-[10px] font-black text-gray-400 uppercase">Patron</th><th class="p-8 text-[10px] font-black text-gray-400 uppercase">Sigil</th><th class="p-8 text-[10px] font-black text-gray-400 uppercase">Style</th><th class="p-8"></th></tr></thead>
                    <tbody id="admin-list" class="divide-y divide-gray-50"></tbody>
                </table>
            </div>
        </div>
    </main>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
        import { getFirestore, collection, addDoc, onSnapshot, deleteDoc, doc } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

        // YOUR ACTUAL FIREBASE CONFIG
        const firebaseConfig = {
            apiKey: "AIzaSyBiSjTQ0lRDwccIxzVb24V8j5ThR8boqJA",
            authDomain: "yahuashopcloud.firebaseapp.com",
            projectId: "yahuashopcloud",
            storageBucket: "yahuashopcloud.firebasestorage.app",
            messagingSenderId: "439516384242",
            appId: "1:439516384242:web:77a3f41653c8d01988b96b"
        };

        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);
        const colRef = collection(db, "orders");

        // GLOBAL HELPERS
        window.go = (id) => {
            ['home', 'login', 'admin'].forEach(v => document.getElementById(v).classList.add('hidden'));
            document.getElementById(id).classList.remove('hidden');
        };

        let curCol = '#facc15';
        let curColName = 'Yellow';
        let isR = false;

        // UI ACTIONS
        window.setCol = (hex, name) => {
            curCol = hex; curColName = name;
            document.querySelectorAll('.dot').forEach(d => d.classList.remove('active'));
            document.getElementById('dot-' + (name === 'Yellow' ? 'yellow' : 'brown')).classList.add('active');
            update();
        };

        window.toggleR = () => {
            isR = !isR;
            document.getElementById('rBox').innerHTML = isR ? '✓' : '';
            update();
        };

        function update() {
            const b = document.getElementById('preview-box');
            const c = document.getElementById('preview-cont');
            b.innerText = document.getElementById('letter').value;
            if(isR) { c.classList.add('gold-plate'); b.style.color = "#8a6d3b"; }
            else { c.classList.remove('gold-plate'); b.style.color = curCol; }
        }

        // FIREBASE ACTIONS
        window.placeOrder = async () => {
            const name = document.getElementById('cust-name').value;
            if(!name) return alert("Please enter your name!");
            const btn = document.getElementById('submit-btn');
            btn.innerText = "SENDING TO YAHIA...";
            btn.disabled = true;

            await addDoc(colRef, {
                name: name,
                item: isR ? "ROYAL " + document.getElementById('letter').value : document.getElementById('letter').value,
                style: isR ? "Imperial Gold" : curColName,
                created: Date.now()
            });

            btn.innerText = "SUBMIT COMMISSION";
            btn.disabled = false;
            document.getElementById('cust-name').value = '';
            alert("Order Locked In! Pay at school.");
        };

        window.auth = () => {
            if(document.getElementById('pass').value === 'MADMIN') {
                go('admin');
                document.getElementById('pass').value = '';
            } else alert("Invalid Access Key");
        };

        // REAL-TIME LEDGER SYNC
        onSnapshot(colRef, (snap) => {
            const list = document.getElementById('admin-list');
            list.innerHTML = '';
            snap.docs.forEach(d => {
                const data = d.data();
                list.innerHTML += `<tr>
                    <td class="p-8 font-black serif text-xl">${data.name}</td>
                    <td class="p-8 font-black text-[#c5a059] text-2xl">${data.item}</td>
                    <td class="p-8 text-[10px] font-black uppercase tracking-widest">${data.style}</td>
                    <td class="p-8 text-right"><button onclick="deleteOrder('${d.id}')" class="text-red-500 font-black text-[10px] uppercase underline">Mark Paid</button></td>
                </tr>`;
            });
        });

        window.deleteOrder = async (id) => {
            await deleteDoc(doc(db, "orders", id));
        };

        // SETUP
        const sel = document.getElementById('letter');
        "ABCDEFGHIJKLMNOPQRSTUVWXYZ".split("").forEach(l => {
            const opt = document.createElement('option');
            opt.value = l; opt.innerText = "Letter " + l;
            sel.appendChild(opt);
        });
        sel.onchange = update;
        update();
    </script>
</body>
</html>
